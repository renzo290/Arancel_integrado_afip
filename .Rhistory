codigo_AFIP),
codigo_AFIP=ifelse((NCM==26169000 ),72910, #Minerales preciosos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==26180000 ),241009, #Industrias básicas de hierro y acero
codigo_AFIP),
codigo_AFIP=ifelse((NCM==27011900 ),51000, #Extracción de carbón
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=27040010 & NCM<= 27060000),191000, #Fabricación de productos de coque
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=27075000 & NCM<=27141000),192000, #Fabricación de productos de la refinación del petróleo
codigo_AFIP),
codigo_AFIP=ifelse((NCM==28013000 ) | (NCM>=28091000 & NCM<=28334010) | (NCM>=28342930 & NCM<=28353110) | (NCM>=28366000 & NCM<=28369911) | (NCM>=28371914 & NCM<=28433090) | (NCM>=28499010 & NCM<=28539019),201180, #Materias químicas inorgánicas básicas ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==28042910),201110, #Fabricación de gases industriales y medicinales comprimidos o licuados
codigo_AFIP),
codigo_AFIP=ifelse((NCM==28080020 | (NCM>=28342110 & NCM<=28342190) | NCM==28369913 | (NCM>=31025019 & NCM<=31054000)),201300, #Abonos y compuestos de nitrógeno
codigo_AFIP),
codigo_AFIP=ifelse((NCM==28441000),201140, #Combustible nuclear
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=29012200 & NCM<=29221996) | NCM==29225039 | NCM==29242119 | NCM==29251990 | NCM==29252950 | (NCM>=29242931 & NCM<=29242932) | (NCM>=29252950 & NCM<=29269022) | (NCM>=29291010 & NCM<=29321310) | (NCM>=29329992 & NCM<=29329994) | (NCM>=29332991 & NCM<=29333110) | (NCM==29339961 ) | NCM==29349915 | NCM==29420000 | (NCM>=38029030 & NCM<=38070000),201190, #Materias químicas orgánicas básicas ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=29224190 & NCM<=29225031) | (NCM>=29239020 & NCM<=29241931) | (NCM>=29242969 & NCM<=29242996) | NCM==29252919 | NCM==29252950 | (NCM>=29280020 & NCM<=29280042) | NCM==29321910 | (NCM>=29331112 & NCM<=29332924) | (NCM>=29333371 & NCM<=29339954) | (NCM>=29343010 & NCM<=29349141) | (NCM>=29349922 & NCM<=29419092) | (NCM>=30021011 & NCM<=30049075)  , 210010, #Medicamentos de uso humano
codigo_AFIP),
codigo_AFIP=ifelse((NCM==29339956),210020, #Medicamento de uso veterinario
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=30059019 & NCM<=30069110),210090, #Fabricación de productos de laboratorio y productos botánicos de uso farmaceútico n.c.p.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=32019090 & NCM<=32029013),201120, #Fabricación de curtientes
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=32030029 & NCM<=32065029),201130, #Colorantes básicos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=33012520 & NCM<=33019010) | NCM==34031110 | (NCM>=37011021 & NCM<=37039090)  |NCM==37079030  |(NCM>=38112130 & NCM<=38112140) | (NCM>=38151100 & NCM<=38159092) | (NCM>=38231900 & NCM<=38249954),202908, #Productos químicos ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==33012520 | NCM==33062000),202320, #Fabricación de cosméticos, perfumes y  productos de higiene y tocador
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=34021210 & NCM<=34029031),202320, #Fabricación de jabones y detergentes
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=34031110 & NCM<=34049014),202311, #Fabricación de preparados para limpieza, pulido y saneamiento
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=36030000 & NCM<=36061000),202906, #Explosivos y pirotecnia
codigo_AFIP),
codigo_AFIP=ifelse((NCM==37061000),591110, #Producción de filmes y videocintas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=38085010 & NCM<=38089422),202101, #Insecticidas y plaguicidas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=38099120 & NCM<=38099219),202907, #Colas, adhesivos y aprestos (incluye tratamiento textiles)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=38123012 & NCM<=38123921) | (NCM>=39069021 & NCM<=39076000) | (NCM>=39093010 & NCM<=39140011) | (NCM>=40021120 & NCM<=40029930),201401, #Fabricación de resinas y cauchos sintéticos (incluye poliuretano)
codigo_AFIP),
codigo_AFIP=ifelse((NCM==38160012 | NCM==68159110 | (NCM>=69021090 & NCM<=69039019)),239100, #Producción de cerámica refractaria
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=39013010 & NCM<=39059930) | (NCM>=39081013 & NCM<=39089010) ,201409, #Fabricación de productos plásticos en forma primaria ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=39171010 & NCM<=39219012),222090, #Fabricación de productos plásticos en formas básicas y artículos de plástico n.c.p., excepto muebles
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=40012100 & NCM<=40012910),12900, #Caucho natural (cultivos perennes)
codigo_AFIP),
codigo_AFIP=ifelse((NCM==40030000  | NCM==50072010),382020, #Caucho regenerado, desperdicios de seda (recuperación de residuos)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=40059110 & NCM<=40070019 ) | (NCM>=40151100 & NCM<=40169400),221909, #Productos de caucho ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=40114000 & NCM<=40121900 ) | (NCM>=84099113 & NCM<=84099971) | (NCM>=87084011 & NCM<=87089529),293090, #Autopartes (neumáticos de caucho)
codigo_AFIP),
codigo_AFIP=ifelse((NCM==41019010 ),101013, #Saladero de cuero y pieles de bovino
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=41041123 & NCM<= 41139000),151100, #Curtido y terminación de cueros
codigo_AFIP),
codigo_AFIP=ifelse((NCM==42032100 ),323001, #Artículos deportivos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==43019000 ),14930, #Cría de animales para pieles
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=44050000 & NCM<= 44071900) | NCM==44031000 ,161002, #Aserrado madera implantada
codigo_AFIP),
codigo_AFIP=ifelse(NCM==44034900 | (NCM>=44072950 & NCM<=44079940) ,161001, #Aserrado madera nativa
codigo_AFIP),
codigo_AFIP=ifelse((NCM==44011000 ),22010, #Extracción bosques cultivados
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=44081010 & NCM<= 44130000),162100, #Fabricación de hojas de madera para enchapado; fabricación de tableros contrachapados; tableros laminados; tableros de partículas y tableros y paneles n.c.p.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==44160090 ),162300, #Recipientes de madera
codigo_AFIP),
codigo_AFIP=ifelse((NCM==44170020 | (NCM>=44190000 & NCM<=44219000) | (NCM>=46012100 & NCM<=46021200)),162909, #Productos de madera ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=44184000 & NCM<=44189000 ),162201, #Productos de madera ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==45020000 ),162903, #Productos de corcho
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=47042900 & NCM<=47071000),170101, #Pasta de papel
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=48010010 & NCM<=48030010) | (NCM>=48044200 & NCM<=48232091),170102, #Papel y cartón excepto envases
codigo_AFIP),
codigo_AFIP=ifelse((NCM==45020000 ),162903, #Productos de corcho
codigo_AFIP),
codigo_AFIP=ifelse((NCM==48232091 ),170990, #Artículos de papel o cartón ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=49070010 & NCM<=49081000),181109, #Billetes y cheques (impresión ncop.)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=51011900 & NCM<=51021100),14710, #Lana y pelos de cabra crudos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=51051000 & NCM<=51052991),131120, #Preparación fibras textiles origen animal
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=51061000 & NCM<=51099000),131131, #Hilados de lana
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=51119000 & NCM<=51121100),131201, #Tejidos de lana
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=52030000 & NCM<=52064200),131132, #Hilados de agodón
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=52081300 & NCM<=52122500),131202, #Tejidos de algodón
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=53050090 & NCM<=53082000) | (NCM>=54012090 & NCM<=54041200) | (NCM>=55091290 & NCM<=55109090),131139, #Hilados textiles ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=53091100 & NCM<=53101090) | (NCM>=54071021 & NCM<=54083300) | (NCM>=55121100 & NCM<=55162200) | (NCM>=58013600 & NCM<=58041090) | NCM==70195290,131209, #Tejidos textiles ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=55019000 & NCM<=55063000),203000, #Fibras manufacturadas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=56012211 & NCM<=56050090) | (NCM>=58063900 & NCM<=59114000),139900, #Productos textiles ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=56072100 & NCM<=56079020),139400, #Cuerdas, cordeles
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=57019000 & NCM<=57039000),139300, #Tapices, alfombras
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=60011020 & NCM<=60064400),139100, #Tejidos de punto
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=61012000 & NCM<=61149010) |(NCM>=61019090 & NCM<=61089900) | (NCM>=61178010 & NCM<=61179000),143020, #Prendas de vestir de punto (algunos podrían ir en confección de ropa interior)
codigo_AFIP),
codigo_AFIP=ifelse((NCM==61121100 ),141140, #Prendas deportivas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=61151091 & NCM<=61153020),143010, #Medias
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=62029100 & NCM<=62059010)| NCM==62113910,141199, #Prendas de vestir ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=62079990 & NCM<=62089900),141110, #Ropa interior
codigo_AFIP),
codigo_AFIP=ifelse((NCM==62099010),141130, #Prendas bebés
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=62132000 & NCM<=62159000),141191, # Accesorios de vestir excepto cuero
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=63025910 & NCM<=63039900),139202, # Ropa de cama y mantelería
codigo_AFIP),
codigo_AFIP=ifelse((NCM==63041100 ),139201, # Mantas, colchas, ponchos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=63051000 & NCM<=63053310 ),139204, # Mantas, colchas, ponchos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=63061910 & NCM<=63064090 ) | NCM==88040000,139209, # Artículos textiles ncop. excepto prendas
codigo_AFIP),
codigo_AFIP=ifelse((NCM==64019990 ),152021, # Calzado ncop. excepto deportivo y ortopédico
codigo_AFIP),
codigo_AFIP=ifelse((NCM==64035110 ),152011, # Calzado de cuero excepto deportivo
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=66019190 & NCM<=67042000 ),329090, # Industria manufacturera ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==68021000),239600, # Tallado de piedra
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=68114000 & NCM<=68118100),239593, #Artículos de cemento, fibrocemento, excl. hormigón
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=68114000 & NCM<=68159919 & NCM!=68159110),239900, #Productos minerales no metálicos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=69041000 & NCM<=69060000) | (NCM>=69089000 & NCM<=69141000),239209, #Cerámica de uso estructural, no refractaria
codigo_AFIP),
codigo_AFIP=ifelse((NCM==69079000),239202, #Revestimientos cerámicos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=70023200 & NCM<=70023900) | (NCM>=70111090 & NCM<=70193200 ) | NCM==91143000,231090, #Productos de vidrio ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==70053000),231020, #Vidrio plano
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=71049000 & NCM<=71051000) | (NCM>=71141900 & NCM<=71161000) | (NCM>=71189000 & NCM<=71189000) | NCM==71181090,321011, #Joyas finas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=71069290 & NCM<=71129200) | (NCM>=74032200 & NCM<=74112290) | (NCM>=75021090 & NCM<=75072000) | (NCM>=78011011 & NCM<=81109000) ,242090, #Metales preciosos O no ferrosos primarios o semi-elaborados
codigo_AFIP),
codigo_AFIP=ifelse((NCM==71171100 | NCM==91132000),321020, #Joyas de fantasía
codigo_AFIP),
codigo_AFIP=ifelse((NCM==72011000),243100, #Fundición de hierro y acero
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=72021100 & NCM<=72052100) | (NCM>=73021010 & NCM<=73024000),241009, # Industria básica  de hierro y acero n.c.p.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=72071110 & NCM<=73012000) | (NCM>=73042310 & NCM<=73062900),241001, # Laminación y estirado. Producción de lingotes, planchas o barras fabricadas por operadores independientes
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=73143100 & NCM<=73144200),259991, #Tejidos de alambre
codigo_AFIP),
codigo_AFIP=ifelse((NCM==73152000 | (NCM==84829111)),281400, #Engranajes, cojinetes, cadenas de eslabones
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=73211200 & NCM<=73218200),275010, #Cocinas, calefones, estufas y calefactores no eléctricos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=73242100 & NCM<=73269010) | (NCM>=74199100 & NCM<=74199930) | (NCM>=76141010 & NCM<=76152000) | NCM==82100010 | (NCM>=83040000 & NCM<=83089020),259999, #Productos elaborados de metal ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=76020000 & NCM<=76071910),242010, #Aluminio primario o semielaborado
codigo_AFIP),
codigo_AFIP=ifelse((NCM==82149010),259302, #Cuchillería
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84013000 & NCM<=84022000) | (NCM>=84049010 & NCM<=84049090),251300, #Generadores de vapor (incl.reactores nucleares)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84031090 & NCM<=84041020),251200, #Tanques, depósitos y recipientes de metal
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84068200 & NCM<=84072990) | (NCM==84101200 | NCM==84118100),281100, #Motores y turbinas salvo para vehículos (salvo barcos)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84111200 & NCM<=84112200) | (NCM>=88022021 & NCM<=88023039) | (NCM>=94011010 & NCM<=94011090),303000, #Fabricación de aeronaves
codigo_AFIP),
codigo_AFIP=ifelse((NCM==84134000),281201, #Bombas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84144010 & NCM<=84145120),281301, # Compresores, grifos y válvulas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84145110 & NCM<=84145120),275091, # Ventiladores de uso doméstico
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84151090 & NCM<=84145120) | (NCM>=84194010 & NCM<=84201010) | (NCM>=84212911 & NCM<=84248290) | NCM==84864000 | (NCM>=84151090 & NCM<=84158300),281900, # Maquinaria de uso general ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84163000 & NCM<=84178010),281500, # Hornos y quemadores
codigo_AFIP),
codigo_AFIP=ifelse((NCM==84211190) | (NCM>=84383000 & NCM<=84388010) | NCM==84789000,282500, #Maquinaria para elaboración de alimentos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84253990 & NCM<=84289030) | (NCM==84312019) | (NCM==87099000),281600, # Maquinaria de elevación y manipulación de cargas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84295119 & NCM<=84303990) | NCM==84314200 | (NCM>=84742010 & NCM<=84748010),282400, # Maquinaria para explotación de minas y canteras
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84323010 & NCM<=84324000),282120, # Maquinaria de uso agrícola
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84391030 & NCM<=84424020),282901, # Maquinaria para industria del papel
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84433114 & NCM<=84439921) | (NCM>=84716080 & NCM<=84717021) |  NCM==88052900,262000, # Equipo informático (agregamos simuladores de vuelo)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84451110 & NCM<=84490091) | (NCM>=84502090 & NCM<=84531010),282600, # Maquinaria para elaboración de productos textiles
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84541000 & NCM<=84552290),282300, # Maquinaria metalúrgica
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84561090 & NCM<=84672910),282200, # Máquinas herramienta
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84729030 & NCM<=84735039),281700, # Aparatos de oficina no electrónicos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=84771011 & NCM<=84775100) | (NCM>=84794000 & NCM<=84807990),282909, # Maquinaria de uso especial ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85013411 & NCM<=85049020),271010, # Motores eléctricos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==85052010) | (NCM>=85112090 & NCM<=85124020) | (NCM==85301010) | (NCM>=85433090 & NCM<=85437040) | (NCM>=85472010 & NCM<=85481090),279000, #Equipos eléctricos ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85061020 & NCM<=85079010),272000, # Pilas y acumuladores eléctricos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85094020 & NCM<=85109019),275099, # Aparatos de uso doméstico
codigo_AFIP),
codigo_AFIP=ifelse((NCM==85139000) | (NCM>=85394110 & NCM<=85399020),274000, # Lámparas eléctricas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85142020 & NCM<=85167920 ),275092, # Planchas, calefactores, hornos eléctricos, tostadoras y otros aparatos generadores de calor
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85171100 & NCM<=85176295 )| NCM==85255019,263000, # Equipos de telecomuniCación
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85181010 & NCM<=85211081 ) | (NCM>=85271300 & NCM<=85299030),264000, # Receptores de radio y televisión, grabadores de sonido
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85232120 & NCM<=85234190 ),268000, # Soportes ópticos y magnéticos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85322310 & NCM<=85340040 ) | (NCM>=85402020 & NCM<=85429090),261000, # Componentes electrónicos
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85363000 & NCM<=85389020 ),271020, # Aparatos de distribución y control de la energía eléctrica
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=85441910 & NCM<=85441990 ),273190, #Hilos y cables aislados ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=86069900 & NCM<=86079900),302000, # Locomotoras y material rodante ferroviario
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=87019090 & NCM<=87019410),282110, # Tractores
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=87024010 & NCM<=87059010),291000, # Vehículos automotores
codigo_AFIP),
codigo_AFIP=ifelse((NCM==87079010 ),292000, # Carrocería
codigo_AFIP),
codigo_AFIP=ifelse((NCM==87100000 ),309900, # Equipo de transporte ncop. (tanques)
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=87112010 & NCM<=87119000),309100, # Motocicletas
codigo_AFIP),
codigo_AFIP=ifelse((NCM==87149500 ),309200, # Bicicletas
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=89012000 & NCM<=89080000 & NCM!=89031000),301100, # Barcos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==89031000 ),301200, # Embarcaciones de recreo y deporte
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=90013000 & NCM<=90049010  & NCM!=90021120) | (NCM>=90118010 & NCM<=90139000),267001, # Equipamientos e instrumentos ópticos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==90021120 | (NCM>=90061010 & NCM<=90101010)),267002, # Equipos y accesorios de fotografía
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=90141000 & NCM<=90179010 ) | (NCM>=90248019 & NCM<=90328924),265101, # Aparatos para medir, controlar
codigo_AFIP),
codigo_AFIP=ifelse((NCM==90181920 | NCM==90184991 | (NCM>=90221200 & NCM<=90221411)),266010, # Equipo médico principalmente eléctrico
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=90183922  & NCM<=90183924)| (NCM>=90211091 & NCM<=90213911),266010, # Equipo médico ncop.
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=91022900 & NCM<=91122000) | (NCM>=91149020 & NCM<=91149070 ),265200, # Fabricación de relojes
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=92011000 & NCM<=92099100 ),322001, #Fabricación de instrumentos de música
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=93031000 & NCM<=93052000 ),252000, #Fabricación de armas y municiones
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=90214000 & NCM<=90219092) |(NCM==94029010 ),266090, #Fabricación de equipo médico y quirúrgico y de aparatos ortopédicos n.c.p
codigo_AFIP),
codigo_AFIP=ifelse(((NCM>=94014010 & NCM<=94015900 ) | NCM==94038200 | NCM==94013010 ),310020, #Fabricación de muebles y partes de muebles
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=94060010 & NCM<=94060099 ),251102, #Fabricación de productos metálicos para uso estructural
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=95030021 & NCM<=95042000 ),324000, #Fabricación de juegos y juguetes
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=95061100 & NCM<=95066100 ),323001, #Fabricación de artículos de deporte
codigo_AFIP),
codigo_AFIP=ifelse((NCM>=96085000 & NCM<=96089990 ),329010, #Fabricación de lápices, lapiceras,  bolígrafos, sellos
codigo_AFIP),
codigo_AFIP=ifelse((NCM==96132000 | NCM==96063000 | NCM==96062900 | NCM==96020020 ),329090, #Industrias manufactureras n.c.p.
codigo_AFIP),
codigo_AFIP=ifelse((NCM==97040000 ),581900, #Edición n.c.p.
codigo_AFIP)
)
faltantes<-faltantes_NCM%>%
subset(is.na(codigo_AFIP))
head(faltantes) #Sólo quedan sin código AFIP nomencladores que son errores o caen en categoría "otros" (9998.)
rm(faltantes)
faltantes_NCM<-faltantes_NCM%>%
subset(!is.na(codigo_AFIP))
faltantes_NCM<-rbind(faltantes_NCM,pesca_procesador_NCM,procesamiento_pescado_continental,
siembra_cereales_oleaginosas,extraccion_bosques_nativos,aserrado_madera_nativa,
ropa_interior_banio
)
frecuencia_NCM<-faltantes_NCM%>%
group_by(NCM)%>%
summarise(freq_NCM=n())
clasificaciones_AFIP<-CUACM_AFIP%>%
select(c(codigo_AFIP,descripcion_AFIP))
faltantes_NCM<-faltantes_NCM%>%
left_join(frecuencia_NCM)%>%
arrange(NCM)%>%
left_join( clasificaciones_AFIP)%>%
subset(!is.na(NCM))
llave_NCM_AFIP<-llave_NCM_AFIP%>%
subset(!is.na(codigo_AFIP) & !is.na(NCM))%>%
rbind(llave_NCM_AFIP,faltantes_NCM)%>%
rename(CLAE_distintos=freq_NCM,
descricpcion_NCM=desc_NCM,
CLAE_6=codigo_AFIP,
descripcion_CLAE=descripcion_AFIP
)%>%
distinct()%>%
subset(!is.na(CLAE_6))
faltantes<-llave_NCM_AFIP%>%
subset(is.na(CLAE_6))
head(faltantes)
ruta_salida<-"C:/Users/Ministerio/Documents/Contribuciones_IVA_exportaciones/Resultados/"
write.xlsx(llave_NCM_AFIP, paste0(ruta_salida,"llave_NCM_AFIP.xlsx"))
rm(procesamiento_pescado_continental,pesca_procesador_NCM,ropa_interior_banio,siembra_cereales_oleaginosas,extraccion_bosques_nativos,aserrado_madera_nativa,
clasificaciones_AFIP,clasificaciones_NCM,CUACM_AFIP,faltantes_CLAE,faltantes_NCM,faltantes
)
######## Contribuciones patronales por sector y provincia exportadora----
start.time<-Sys.time()
df<-read_delim("C:/Users/Ministerio/Documents/MNI/Bases_externas/rd201911_mecon2.csv", delim = "|")[,variables]
df<-df %>% mutate(contp=conss-conos*apanssal/totapoross,      # Contribuciones sin ANSSAL, con totapoross>0
cont=ifelse(totapoross>0,contp,conss-apanssal*2),##Contribuciones sin ANSSAL, aun cuando totapoross=0
sal_imp=ifelse(rem10>0,rem10,remunerac2),  # Salario imponible sobre el que se calculan las contribuciones patronales
sal=sal_imp+impo_detra,                    # Salario imponible que tendrí­an las contribuciones patronales sin el mí­nimo no imponible por empleado Ley 27.430 (variable impo_detra)
alicuota=ifelse(sal_imp>0,cont/sal_imp,0), # Alicuota efectiva: resulta bien, estí¡ concentrada cerca de 18% o de 20,4%
esp=ifelse(impo_detra>7005,1,0),           # Especiales:empresas con MNI por empleado pleno a noviembre de 2019: son las textiles, de economí­as regionales, y de salud privada
activem=1*as.numeric(activem))            #Transformar la variable a numerica
df <- df%>% select(-c(contp))
### Base por empresas
#c1 es el identificador de empresa, empsereve el tipo de empresa, y activem la actividad de la empresa
df<-df%>%
filter(empsereve %in% c("6", "7","9","A","B","C","D"))
table(df$empsereve)
df_emp<-df %>%
group_by(c1,empsereve,activem,zona) %>%
summarize(sal_imp_sum=sum(sal_imp),
sal_sum=sum(sal),
impo_detra_sum=sum(impo_detra),
cont_sum=sum(cont, na.rm=TRUE),
trab=n(),
esp_c1=ifelse(sum(esp)>0,1,0)
)
###
# Acá identificamos a las empresas que tienen el Mínimo No Imponible por empleado pleno, por decretos de 2018 o 2019,
#extendidos pero congelados por la Ley 27.541: textil, economías regionales, salud privada.
#Consideramos que una empresa tiene el MNI pleno si su actividad corresponde a uno de esos tres sectores, y que tiene
#un MNI por empleado superior a $7005 en noviembre de 2019 (esp_c1==1)
Sectores_merge<-sectores %>%
select(codigo_AFIP,Textil,Salud,Agroind)%>%
rename(activem=codigo_AFIP)
df_emp<-df_emp %>% left_join(Sectores_merge)
df_emp<-df_emp %>%
mutate(esp_c2=ifelse(esp_c1==1 & (Textil==1 | Agroind==1|Salud==1),1,0),
MNI_PYME=ifelse(impo_detra_sum>0,
ifelse(trab<=25,10000*13,0)
,0), #Aplicamos el MNI por empresa de $10 mil, Ley 27.541, con hasta 25 empleados.
)%>%
select(-c(Textil, Salud, Agroind))
rm(df)
gc()
df_emp<- df_emp %>% left_join(Zonas)
CLAE_zona<-df_emp%>%
group_by(zona,activem)%>%
summarise(masa_salarial=sum(sal_sum),
masa_sal_imp=sum(sal_imp_sum),
contribuciones=sum(cont_sum),
impo_detra=sum(impo_detra_sum),
trabajadores=sum(trab)
)%>%
ungroup()
df_emp[is.na(df_emp)]<- 0
end.time <-Sys.time()
time.taken<-end.time-start.time
time.taken # 18 minutos
sys.Date()
Sys.Date()
fecha<-Sys.Date()
head(fecha)
anio<-substr(fecha,start=1,stop=4)
anio<-substring(fecha,start=1,stop=4)
anio<-as.numeric(substr(fecha,start=1,stop=4))
mes<-substr(fecha,start=6,stop=7)
library(tidyverse)
require(openxlsx)
setwd("C:/Users/Ministerio/Documents/arancel_integrado_afip")
#Si no estÃ¡ creada, se crea una carpeta para guardar las bases de AFIP
if(!file.exists("Bases_afip")) {
dir.create("Bases_afip")
}
#Se descargan los archivos de la pÃ¡gina de AFIP y se carga el arancel integrado
download.file(
url = "https://www.afip.gob.ar/aduana/arancelintegrado/archivos/arancel.zip",
destfile = "Bases_afip/arancel.zip", mode='wb'
)
unzip(zipfile = 'Bases_afip/arancel.zip', exdir = "Bases_afip")
unlink('Bases_afip/arancel.zip') # Borra el archivo zip
fecha<-Sys.Date()
anio<-as.numeric(substr(fecha,start=1,stop=4))
mes<-substr(fecha,start=6,stop=7)
dia<-substr(fecha,start=9,stop=10)
ruta_base<-"Bases_afip/nomenclador_"
#"Bases_afip/nomenclador_05052022.txt"
nomenclador <- readr::read_delim(paste0(ruta_base,anio,mes,dia,".txt"), #Ponerle fecha de hoy
delim = "@", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
nomenclador <- readr::read_delim(paste0(ruta_base,dia,mes,anio,".txt"), #Ponerle fecha de hoy
delim = "@", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(nomenclador)
#Datos de IVA pagados por sector, y de exportaciones
IVA_exp_2020 <- read_excel(paste0(ruta_bases_externas,"2.1.1.4.xls"),
skip = 7)
names(IVA_exp_2020)<- c("borrar","actividad_economica","presentaciones","ventas_totales","vent_merc_inter_tot","vent_merc_inter_grav","vent_merc_inter_exen","exportaciones")
IVA_exp_2020<-IVA_exp_2020%>%
select(-c("borrar"))%>%
mutate(CLAE_G=substr(IVA_exp_2020$actividad_economica, start = 1, stop = 3))%>%
subset(!is.na(actividad_economica))%>%
subset(CLAE_G!="A -" & CLAE_G!="B -" & CLAE_G!="C -"& CLAE_G!="D -"& CLAE_G!="E -"& CLAE_G!="F -"& CLAE_G!="G -"& CLAE_G!="H -"& CLAE_G!="I -"& CLAE_G!="J -"& CLAE_G!="K -"& CLAE_G!="L -"& CLAE_G!="M -"& CLAE_G!="N -"& CLAE_G!="O -"& CLAE_G!="P -"& CLAE_G!="Q -"& CLAE_G!="R -"& CLAE_G!="S -"& CLAE_G!="Otr")
#Identificamos ahora los pesos de lo exportado por actividad
IVA_exp_2020<-IVA_exp_2020%>%
mutate(porc_expo=ifelse(ventas_totales==0, 0,
exportaciones/ventas_totales)
)%>%
arrange(desc(porc_expo))
view(IVA_exp_2020)
info_NCM<-llave_NCM_AFIP%>%
rename(activem=CLAE_6)%>%
select(c(activem,NCM,descricpcion_NCM))
head(info_NCM)
df_emp_NCM<-df_emp%>%
left_join(info_NCM)%>%
subset(!is.na(c1))%>%
distinct()
head(df_emp_NCM)
View(frecuencia_NCM)
rm(procesamiento_pescado_continental,pesca_procesador_NCM,ropa_interior_banio,siembra_cereales_oleaginosas,extraccion_bosques_nativos,aserrado_madera_nativa,
clasificaciones_AFIP,clasificaciones_NCM,CUACM_AFIP,faltantes_CLAE,faltantes_NCM,faltantes,frecuencia_NCM,info_NCM
)
rm(nomenclador)
rm(fecha,anio,mes,dia,ruta_base)
head(df_emp_NCM)
View(df_emp_NCM)
rm(df_emp_NCM)
gc()
info_NCM<-llave_NCM_AFIP%>%
rename(activem=CLAE_6)%>%
select(c(activem,NCM,descricpcion_NCM))
head(info_NCM)
head(IVA_exp_2020)
View(lista_NCM_Argentina)
View(llave_NCM_AFIP)
#Datos de IVA pagados por sector, y de exportaciones
IVA_exp_2020 <- read_excel(paste0(ruta_bases_externas,"2.1.1.4.xls"),
skip = 7)
names(IVA_exp_2020)<- c("borrar","actividad_economica","presentaciones","ventas_totales","vent_merc_inter_tot","vent_merc_inter_grav","vent_merc_inter_exen","exportaciones")
IVA_exp_2020<-IVA_exp_2020%>%
select(-c("borrar"))%>%
mutate(CLAE_G=substr(IVA_exp_2020$actividad_economica, start = 1, stop = 3))%>%
subset(!is.na(actividad_economica))%>%
subset(CLAE_G!="A -" & CLAE_G!="B -" & CLAE_G!="C -"& CLAE_G!="D -"& CLAE_G!="E -"& CLAE_G!="F -"& CLAE_G!="G -"& CLAE_G!="H -"& CLAE_G!="I -"& CLAE_G!="J -"& CLAE_G!="K -"& CLAE_G!="L -"& CLAE_G!="M -"& CLAE_G!="N -"& CLAE_G!="O -"& CLAE_G!="P -"& CLAE_G!="Q -"& CLAE_G!="R -"& CLAE_G!="S -"& CLAE_G!="Otr")
#Identificamos ahora los pesos de lo exportado por actividad
IVA_exp_2020<-IVA_exp_2020%>%
mutate(porc_expo=ifelse(ventas_totales==0, 0,
exportaciones/ventas_totales)
)%>%
arrange(desc(porc_expo))%>%
mutate(CLAE_3=as.numeric(substr(actividad_economica,start=1,stop=3))
)
view(IVA_exp_2020)
IVA_exp_2020<-IVA_exp_2020%>%
mutate(porc_expo=ifelse(ventas_totales==0, 0,
exportaciones/ventas_totales)
)%>%
arrange(desc(porc_expo))%>%
mutate(CLAE_3=as.numeric(substr(actividad_economica,start=1,stop=3)),
control=as.numeric(CLAE_G)-CLAE_3
)
table(IVA_exp_2020$control)
IVA_exp_2020<-IVA_exp_2020%>%
mutate(porc_expo=ifelse(ventas_totales==0, 0,
exportaciones/ventas_totales)
)%>%
arrange(desc(porc_expo))%>%
mutate(CLAE_3=as.numeric(CLAE_G)
)%>%
select(c(actividad_economica,CLAE_3,porc_expo))
view(IVA_exp_2020)
